## 오늘 무엇을 했나

- 이번주 코드숨 강의에서 테스트 코드를 작성하는 법에 대해 배웠다. `Junit5`을 이용한 간단한 테스트 작성법만 알았지 `Spring`을 테스트 하는 방법과 `Mockito`를 이용한 클래스를 모킹하는 방법을 배웠다. 처음 해보는 새로운 개념들과 테스트와 관련된 여러 프레임워크에 대한 지식들이 한번에 머릿속에 들어와서 굉장히 혼란스러웠다.

## 무엇을 배웠나

- `MockMvc` 를 이용한 `SpringMvc` 슬라이스 테스트 방법

  - `@WebMvcTest` 어노테이션을 이용하면 `Controller` 와 `ControllerAdivce` 같은 `SpringMvc`에 관련된 `Bean` 들만 로드한다. 이런식으로 주요 관심사에 대한 테스트 방법을 슬라이스 테스트라고 한다.

  - 대표적인 슬라이스

    - `@WebMvcTest`
    - `@WebFluxTest`
    - `@DataJpaTest`
    - `@JsonTest`
    - `@RestClientTest`

  - `jsonPath` 을 이용한 `json` 검증

    ```java
      mockMvc.perform(get("/tasks"))
                    .andExpect(status().isOk())
                    .andExpect(jsonPath("$.length()").value(1))
                    .andExpect(jsonPath("$[0].id").value(TASK_ID))
                    .andExpect(jsonPath("$[0].title").value(TASK_TITLE));
    ```

    `jsonPath`를 이용하면 `MockMvc`에서 쉽게 `json`을 검증할 수 있다.
    `$.key`을 이용해 검증 할 `key`값을 가져오고 그후에 value() 같은 검증할 내용이 들어간다.

- `Mockito`를 메소드를 `Stubbing` 하는 방법

  - 특정 클래스를 모킹하여 메소드같은 행위를 조작하는 행위를 `Stubbing` 이라고 한다

  - `given()` 을 이용하여 `Stubbing` 방법

    ```java
      // task의 참조 값만 들어올 때 이 메소드를 stubbing 하겠다는 의미
      given(taskService.createTask(task)).willReturn(task);
    ```

    참고로 매개변수를 캡처링 하기 때문에 참조 값이 다르면 동작을 안한다 이럴 경우 `ArgumentMatchers` 에 있는 `static method`를 이용하면 다양하게 조작 할 수 있다.

    ```java
      // ArgumentMatchers any()를 이용하면 어떤 값이 들어와도 stubbing 하겠다는 뜻임
      given(taskService.createTask(any())).willReturn(task);
    ```

## 내일을 무엇을 할꺼냐

- 사실 이번 주에 복습겸 JPA 책을 다시 읽을려고 했는데 테스트 코드에 익숙해지는게 먼저인거 같다. 그냥 무지성 테스트코드 삽질하고 리뷰를 받는게 요번 주 목표이자 내일 목표다.
